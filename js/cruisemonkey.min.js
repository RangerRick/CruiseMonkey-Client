!function(){"use strict";"function"!=typeof String.prototype.capitalize&&(String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1).toLowerCase()}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a){return 0===this.lastIndexOf(a,0)}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(a){return-1!==this.indexOf(a,this.length-a.length)})}(),function(){"use strict";angular.module("cruisemonkey.Config",[]).value("config.logging.useStringAppender",!1).value("config.database.host","cm.raccoonfink.com").value("config.database.name","cruisemonkey").value("config.database.replicate",!0).value("config.app.version","3.90")}(),function(){"use strict";angular.module("cruisemonkey.controllers.About",["cruisemonkey.Logging","cruisemonkey.Config"]).controller("CMAboutCtrl",["$scope","$rootScope","LoggingService","config.app.version",function(a,b,c,d){c.info("Initializing CMAboutCtrl"),b.title="About CruiseMonkey "+d}])}(),function(){"use strict";angular.module("cruisemonkey.controllers.DeckList",["ngRoute","cruisemonkey.Logging","hammer"]).controller("CMDeckListCtrl",["$scope","$rootScope","$routeParams","$location","LoggingService",function(a,b,c,d,e){e.info("Initializing CMDeckListCtrl"),a.deck=parseInt(c.deck,10),b.title="Deck "+a.deck,a.previous=function(){f()},a.next=function(){g()},a.safeApply=function(a){var b=this.$root.$$phase;"$apply"===b||"$digest"===b?a&&"function"==typeof a&&a():this.$apply(a)};var f=function(){a.safeApply(function(){if(2!==a.deck){var b=a.deck-1;e.info("previous() going down to deck "+b),d.path("/deck-plans/"+b)}})},g=function(){a.safeApply(function(){if(15!==a.deck){var b=a.deck+1;e.info("next() going up to deck "+b),d.path("/deck-plans/"+b)}})},h=function(a){return console.log("received event: ",a),37===a.keyCode?(f(),!1):39===a.keyCode?(g(),!1):!0};b.actions=[],2!=a.deck&&b.actions.push({name:"Previous",iconClass:"arrow-left4",launch:function(){f()}}),15==a.deck?b.actions.push({name:"Blank",iconClass:"blank",launch:function(){}}):b.actions.push({name:"Next",iconClass:"arrow-right4",launch:function(){g()}}),document.addEventListener("keydown",h,!0),a.$on("$destroy",function(){document.removeEventListener("keydown",h,!0)})}])}(),function(){"use strict";angular.module("cruisemonkey.controllers.Events",["ngRoute","cruisemonkey.User","cruisemonkey.Events","cruisemonkey.Logging","ui.bootstrap.modal"]).filter("orderObjectBy",function(){return function(a,b){if(!angular.isObject(a))return a;angular.isArray(b)||(b=[b]);var c=[];for(var d in a)c.push(a[d]);return c.sort(function(a,c){for(var d=0;d<b.length;d++){var e=b[d];if("start"===e||"end"===e||angular.isDate(a[e])||angular.isDate(c[e])){var f=moment(a[e]),g=moment(c[e]);if(f.isBefore(g))return-1;if(f.isAfter(g))return 1}else if(angular.isNumber(a[e])||angular.isNumber(c[e])){if(a[e]>c[e])return 1;if(a[e]<c[e])return-1}else{var h=String(a[e]).toLowerCase(),i=String(c[e]).toLowerCase();if(h>i)return 1;if(i>h)return-1}}return 0}),c}}).controller("CMEditEventCtrl",["$q","$scope","$rootScope","$modal","UserService","LoggingService",function(a,b,c,d,e,f){f.info("Initializing CMEditEventCtrl");var g="YYYY-MM-DD HH:mm";if(Modernizr.inputtypes["datetime-local"]&&(g="YYYY-MM-DDTHH:mm"),c.editEvent)b.event=angular.copy(c.editEvent),delete c.editEvent,b.event.start=moment(b.event.start).format(g),b.event.end=moment(b.event.end).format(g),f.info("Found existing event to edit."),console.log(b.event);else{var h=new Date;b.event={start:moment(h).format(g),end:moment(new Date(h.getTime()+36e5)).format(g),type:"event",username:e.getUsername(),isPublic:!0},f.info("Created fresh event."),console.log(b.event)}}]).controller("CMEventCtrl",["$scope","$rootScope","$timeout","$routeParams","$location","$q","$modal","$templateCache","UserService","EventService","LoggingService","events",function(a,b,c,d,e,f,g,h,i,j,k,l){k.info("Initializing CMEventCtrl"),a.eventType=d.eventType,b.title=d.eventType.capitalize()+" Events";var m=!0,n=!1;a.safeApply=function(a){var b=this.$root.$$phase;"$apply"===b||"$digest"===b?a&&"function"==typeof a&&a():this.$apply(a)},a.refresh=function(){n||(n=!0,c(function(){k.info("Refreshing event list.");var b;"official"===d.eventType?b=j.getOfficialEvents:"unofficial"===d.eventType?b=j.getPublicEvents:"my"===d.eventType?b=j.getMyEvents:k.warn("unknown event type: "+d.eventType),f.when(b()).then(function(b){var c,d={};for(c=0;c<b.length;c++){var e=b[c];e.hasOwnProperty("isFavorite")||(e.isFavorite=!1),d[e._id]=e}n=!1,m=!1,angular.forEach(d,function(b,c){a.events[c]=b}),angular.forEach(a.events,function(b,c){d[c]||delete a.events[c]})})},250))},a.fuzzy=function(a){return moment(a).fromNow()},a.justTime=function(a){return moment(a).format("HH:mm")},a.trash=function(b){a.safeApply(function(){f.all([j.removeEvent(b),a.events]).then(function(a){var b=a[0],c=a[1];console.log("removed = ",b),delete c[b.id]})})},a.edit=function(c){a.safeApply(function(){console.log("edit: ",c),c.start=moment(c.start).format("YYYY-MM-DD HH:mm"),c.end=moment(c.end).format("YYYY-MM-DD HH:mm"),b.editEvent=c;var d=g.open({templateUrl:"edit-event.html",controller:"CMEditEventCtrl"});d.result.then(function(b){k.info("Save finished!"),console.log(b),f.all([j.updateEvent(b),a.events]).then(function(a){var c=a[1];c[b._id]=b,k.info("Finished updating event.")})},function(){k.warn("Add canceled!")})})},a.onFavoriteChanged=function(a,b){b?j.addFavorite(a):j.removeFavorite(a)},a.onPublicChanged=function(b,c){console.log("onPublicChanged: ",b,c),b.isPublic=c,f.when(a.events).then(function(a){a[b._id].isPublic=c,j.updateEvent(a[b._id])})},a.$on("cm.eventCacheUpdated",function(){}),b.actions=[],i.getUsername()&&""!==i.getUsername()&&b.actions.push({name:"Add Event",iconClass:"add",launch:function(){k.info("launching modal");var b=g.open({templateUrl:"edit-event.html",controller:"CMEditEventCtrl"});b.result.then(function(b){k.info("Save finished!"),console.log(b),f.all([j.addEvent(b),a.events]).then(function(a){var b=a[0],c=a[1];c[b._id]=b})},function(){k.warn("Add canceled!")})}}),a.events=l}])}(),function(){"use strict";angular.module("cruisemonkey.controllers.Header",["cruisemonkey.Logging"]).controller("CMHeaderCtrl",["$scope","$rootScope","$location","LoggingService",function(a,b,c,d){d.info("Initializing CMHeaderCtrl")}])}(),function(){"use strict";angular.module("cruisemonkey.controllers.Login",["cruisemonkey.Logging","cruisemonkey.User"]).controller("CMLoginCtrl",["$scope","$rootScope","$location","UserService","LoggingService",function(a,b,c,d,e){e.info("Initializing CMLoginCtrl"),b.title="Log In",b.user=d.get(),a.isUnchanged=function(a){var b=d.get();return null===b||void 0===b?null===a||void 0===a?!0:!1:b.username===a.username&&b.password===a.password},a.reset=function(){var a=d.get();e.info("resetting user: ",a),b.user=a,b.$broadcast("cm.loggedOut"),c.path("/events/official")},a.update=function(a){return"official"===a.username?(console.log('Attempt to log in as "official", skipping.'),c.path("/events/official"),void 0):(a.loggedIn=!0,e.info("saving user"),console.log(a),d.save(a),b.user=d.get(),b.$broadcast("cm.loggedIn"),c.path("/events/my"),void 0)}}])}(),function(){"use strict";angular.module("cruisemonkey.controllers.Logout",["cruisemonkey.Logging","cruisemonkey.User"]).controller("CMLogoutCtrl",["$scope","$rootScope","$routeParams","$location","UserService","LoggingService",function(a,b,c,d,e,f){f.info("Initializing CMLogoutCtrl"),b.title="Logging Out",b.user=e.reset(),d.replace(),d.path("/events/official")}])}(),function(){"use strict";angular.module("cruisemonkey.Navigation",["cruisemonkey.Logging"]).controller("CMNavigationCtrl",["$rootScope","$scope","$location","$document","UserService","LoggingService","$mobileFrame",function(a,b,c,d,e,f,g){f.info("Initializing CMNavigationCtrl"),b.toggleDrawer=function(){return g.navVisible()&&g.toggleNav(),!0}}])}(),function(){"use strict";angular.module("cruisemonkey.Database",["cruisemonkey.Logging","cruisemonkey.Config","ngInterval","angularLocalStorage"]).factory("Database",["$location","$interval","$timeout","$rootScope","LoggingService","storage","config.database.host","config.database.name","config.database.replicate",function(a,b,c,d,e,f,g,h,i){e.info("Initializing CruiseMonkey database: "+h);var j=new Pouch(h),k=null,l=!1;j.compact(),f.bind(d,"_seq",{defaultValue:0,storeName:"cm.db.sync"}),console.log("last sequence: "+d._seq);var m=function(){if(!l){l=!0,e.info("Watching for document changes.");var a=d._seq;a||(a=0),j.changes({since:a,onChange:function(a){console.log("change: ",a),a.seq&&(d._seq=a.seq),a.deleted?d.$broadcast("cm.documentDeleted",a):d.$broadcast("cm.documentUpdated",a.doc)},continuous:!0,include_docs:!0}),d.$broadcast("cm.databaseReady")}},n=function(){if(i){if(null!==k)return e.warn("Replication has already been started!  Timeout ID = "+k),!1;var c=function(){e.info("Attempting to replicate with "+d),j.replicate.to(d,{complete:function(){j.replicate.from(d,{complete:function(){m()}})}})};g||(g=a.host());var d="http://"+g+":5984/cruisemonkey";return e.info("Enabling replication with "+d),k=b(function(){c()},1e4),c(),!0}return e.warn("startReplication() called, but replication is not enabled!"),registerForChanges(),!1},o=function(){return i?null!==k?(e.info("Stopping replication with "+host),b.cancel(k),k=null,!0):(e.info("Replication is already stopped!"),!1):(e.warn("stopReplication() called, but replication is not enabled!"),void 0)},p=function(){void 0!==navigator.connection.type&&void 0!==Connection.WIFI?(console.log("Connection type is: "+navigator.connection.type),navigator.connection.type===Connection.NONE?o():n()):void 0!==navigator.connection.bandwidth&&(console.log("Connection bandwidth is: "+navigator.connection.bandwidth),navigator.connection.bandwidth>0?n():o())};return c(function(){navigator&&navigator.connection?navigator.connection.addEventListener?(e.info("Browser has native navigator.connection support."),navigator.connection.addEventListener("change",p)):(e.info("Browser does not have native navigator.connection support.  Trying with phonegap."),document.addEventListener("online",p),document.addEventListener("offline",p)):(e.warn("Unsure how to handle connection management; starting replication and hoping for the best."),n())},10),e.info("Finished initializing CruiseMonkey database."),{database:j,startReplication:n,stopReplication:o}}])}(),function(){"use strict";angular.module("cruisemonkey.Events",["cruisemonkey.Database","cruisemonkey.User","cruisemonkey.Logging"]).factory("EventService",["$q","$rootScope","$timeout","Database","UserService","LoggingService",function(a,b,c,d,e,f){var g=function(a){return null===a||void 0===a?void 0:moment(a).format("YYYY-MM-DD HH:mm")},h=!1;b._eventCache={};var i=function(){b._eventCache={},h||(h=!0,c(function(){a.all([t(),u(),w()]).then(function(a){b._eventCache.official=a[0],b._eventCache["public"]=a[1],b._eventCache.my=a[2],h=!1,b.$broadcast("cm.eventCacheUpdated")})},250))},j=function(a,c){b._eventCache[a]=c},k=function(a,c){return b._eventCache.hasOwnProperty(c)?(f.info("cache hit: "+c),o(b._eventCache[c])):(f.info("cache miss: "+c),a())},l=[],m=!1;angular.forEach(["cm.databaseReady","cm.documentDeleted","cm.documentUpdated","cm.loggedIn","cm.loggedOut"],function(a){l.push(b.$on(a,function(){"cm.databaseReady"===a&&(m=!0),m&&i()}))}),b.$on("$destroy",function(){angular.forEach(l,function(a){a()})});var n=function(c,e,g){var h=a.defer();return d.database.query({map:c},e,function(a,c){b.$apply(function(){if(a)f.error(a),h.reject(a);else{var b,d=[];for(b=0;b<c.total_rows;b++)d.push(c.rows[b].value);j(g,d),h.resolve(d)}})}),h.promise},o=function(c){var d=a.defer();return setTimeout(function(){b.$apply(function(){d.resolve(c)})},0),d.promise},p=function(c){var e=angular.copy(c);e.type="event",e.start=g(e.start),e.end=g(e.end);var h=a.defer();return e.username&&""!==e.username?(f.info('addEvent(): posting event "'+e.summary+'" for user "'+e.username+'"'),d.database.post(e,function(a,c){b.$apply(function(){a?(f.error(a),h.reject(a)):(e._id=c.id,e._rev=c.rev,h.resolve(e))})})):(f.info("addEvent(): no username in the event!"),h.reject("no username specified")),h.promise},q=function(c){var e=a.defer();if(!c._rev||!c._id)return f.warn("Attempting to update event "+c.summary+", but it is missing _rev or _id!"),e.reject("bad event"),e.promise;var h=angular.copy(c);delete h.isFavorite,h.start=g(h.start),h.end=g(h.end),d.database.put(h,function(a,c){b.$apply(function(){a?(f.error(a),e.reject(a)):(h._rev=c.rev,e.resolve(c))})})},r=function(c){f.info("removeEvent("+c._id+")");var e=a.defer();return d.database.remove(c,function(a,c){b.$apply(function(){a?(f.error(a),e.reject(a)):e.resolve(c)})}),e.promise},s=function(){return f.info("getAllEvents()"),n(function(a){"event"===a.type&&emit(a.username,a)},{reduce:!1},"all")},t=function(){return f.info("getOfficialEvents()"),n(function(a){"event"===a.type&&emit(a.username,a)},{reduce:!0,key:"official"},"official")},u=function(){return f.info("getPublicEvents()"),n(function(a){"event"===a.type&&a.isPublic&&"official"!==a.username&&emit(a.username,a)},{reduce:!0},"public")},v=function(){f.info("getUserEvents()");var a=e.getUsername();return a?n(function(a){"event"===a.type&&emit(a.username,a)},{reduce:!1,key:a},"user"):(f.warn("getUserEvent(): user not logged in"),o([]))},w=function(){f.info("getMyEvents()");var c=e.getUsername();if(!c)return f.warn("getMyEvents(): user not logged in"),o([]);var g=a.defer();return d.database.query({map:function(a){"event"===a.type?emit(a.username,{_id:a._id,type:a.type}):"favorite"===a.type&&emit(a.username,{_id:a.eventId,type:a.type})}},{reduce:!0,include_docs:!0,key:c},function(a,c){b.$apply(function(){if(a)f.error(a),g.reject(a);else{var b,d,e=[];for(b=0;b<c.total_rows;b++)d=c.rows[b],"favorite"===d.value.type&&(d.doc.isFavorite=!0),e.push(d.doc);j("my",e),g.resolve(e)}})}),g.promise},x=function(){var c=e.getUsername();if(!c)return f.warn("getMyFavorites(): user not logged in"),o([]);var g=a.defer();return d.database.query({map:function(a){"favorite"===a.type&&emit(a.username,a.eventId)}},{reduce:!0,include_docs:!1,key:c},function(a,c){b.$apply(function(){if(a)f.error(a),g.reject(a);else{var b,d=[];for(b=0;b<c.total_rows;b++)d.push(c.rows[b].value);j("favorites",d),g.resolve(d)}})}),g.promise},y=function(c){var g=e.getUsername();if(!g||!c)return f.warn("isFavorite(): user not logged in, or no eventId passed"),o(!1);var h=a.defer();return d.database.query({map:function(a){"favorite"===a.type&&emit({username:a.username,eventId:a.eventId})}},{reduce:!0,include_docs:!1,key:{username:g,eventId:c}},function(a,c){b.$apply(function(){a?(f.error(a),h.reject(a)):h.resolve(c.total_rows>0)})}),h.promise},z=function(c){var g=e.getUsername();if(!g||!c)return f.warn("addFavorite(): user not logged in, or no eventId passed"),o(void 0);var h=a.defer();return d.database.post({type:"favorite",username:g,eventId:c},function(a,c){b.$apply(function(){a?(f.error(a),h.reject(a)):h.resolve(c.id)})}),h.promise},A=function(c){var g=e.getUsername();if(!g||!c)return f.warn("removeFavorite(): user not logged in, or no eventId passed"),o(void 0);var h=a.defer();return d.database.query({map:function(a){"favorite"===a.type&&emit({username:a.username,eventId:a.eventId},a._id)}},{reduce:!0,include_docs:!0,key:{username:g,eventId:c}},function(a,c){b.$apply(function(){if(a)f.error(a),h.reject(a);else if(c.total_rows>0){var e=c.rows[0].doc;d.database.remove(e,function(a,c){b.$apply(function(){a?(f.error(a),h.reject(a)):h.resolve(c)})})}else h.resolve(null)})}),h.promise};return{addEvent:p,updateEvent:q,removeEvent:r,getAllEvents:function(){return k(s,"all")},getOfficialEvents:function(){return k(t,"official")},getPublicEvents:function(){return k(u,"public")},getUserEvents:function(){return k(v,"user")},getMyEvents:function(){return k(w,"my")},getMyFavorites:x,isFavorite:y,addFavorite:z,removeFavorite:A}}])}(),function(){"use strict";function a(){}function b(){}a.prototype=new log4javascript.Appender,a.prototype.layout=new log4javascript.NullLayout,a.prototype.threshold=log4javascript.Level.DEBUG,a.prototype._saLogHistory="",a.prototype._saIndentLevel=0,a.prototype._getPrefix=function(){for(var a="",b=0;b<this._saIndentLevel;b++)a+=" ";return a},a.prototype._increaseIndentLevel=function(){this._saIndentLevel+=2},a.prototype._decreaseIndentLevel=function(){this._saIndentLevel-=2,this._saIndentLevel<0&&(this._saIndentLevel=0)},a.prototype._resetLogHistory=function(){this._saLogHistory="",this._saIndentLevel=0},a.prototype._addToLogHistory=function(a){void 0===this._saLogHistory?this._saLogHistory=this._getPrefix()+a+"\n":this._saLogHistory+=this._getPrefix()+a+"\n"},a.prototype.getLogHistory=function(){return this._saLogHistory||""},a.prototype.append=function(a){var b=this,c=function(){var c=b.getLayout(),d=c.format(a);return c.ignoresThrowable()&&a.exception&&(d+=a.getThrowableStrRep()),d};b._addToLogHistory(c())},a.prototype.group=function(a){this._addToLogHistory("=== "+a+" ==="),this._increaseIndentLevel()},a.prototype.groupEnd=function(){this._decreaseIndentLevel()},a.prototype.toString=function(){return"StringAppender"},b.prototype=new log4javascript.Appender,b.prototype.layout=new log4javascript.NullLayout,b.prototype.threshold=log4javascript.Level.DEBUG,b.prototype.append=function(a){var b=this,c=function(){var c=b.getLayout(),d=c.format(a);return c.ignoresThrowable()&&a.exception&&(d+=a.getThrowableStrRep()),d};console.log(c())},b.prototype.group=function(a){console.group&&console.group(a)},b.prototype.groupEnd=function(){console.groupEnd&&console.groupEnd()},b.prototype.toString=function(){return"ConsoleAppender"},angular.module("cruisemonkey.Logging",["cruisemonkey.Config"]).factory("LoggingService",["config.logging.useStringAppender",function(c){console.log("initializing LoggingService");var d=log4javascript.getLogger();d.removeAllAppenders();var e={getLogHistory:function(){return""},trace:function(){d.trace(Array.prototype.slice.apply(arguments))},debug:function(){d.debug(Array.prototype.slice.apply(arguments))},info:function(){d.info(Array.prototype.slice.apply(arguments))},warn:function(){d.warn(Array.prototype.slice.apply(arguments))},warning:function(){d.warn(Array.prototype.slice.apply(arguments))},error:function(){d.error(Array.prototype.slice.apply(arguments))},fatal:function(){d.fatal(Array.prototype.slice.apply(arguments))}},f=new log4javascript.PatternLayout("%d{HH:mm:ss,SSS} [%-5p] %m");if(c){console.log("initializing StringAppender");var g=new a;g.setLayout(f),d.addAppender(g),e.getLogHistory=function(){return g.getLogHistory()}}else console.log("skipping StringAppender");var h=new b;return h.setLayout(f),d.addAppender(h),e}])}(),function(){"use strict";angular.module("cruisemonkey.User",["angularLocalStorage"]).factory("UserService",function(a,b){return b.bind(a,"_user",{defaultValue:{loggedIn:!1,username:"",password:""},storeName:"cm.user"}),{loggedIn:function(){return a._user.loggedIn},getUsername:function(){return a._user.loggedIn?a._user.username:void 0},get:function(){return angular.copy(a._user)},save:function(b){a._user=angular.copy(b)},reset:function(){return a._user={loggedIn:!1,username:"",password:""},a._user}}})}(),function(){"use strict";angular.module("cruisemonkey.directives",[])}(),function(){"use strict";angular.module("cruisemonkey.filters",[])}(),function(){"use strict";angular.module("cruisemonkey.services",[]).value("version","3.90")}(),function(){"use strict";angular.module("cruisemonkey",["ngRoute","cruisemonkey.filters","cruisemonkey.services","cruisemonkey.directives","cruisemonkey.controllers.About","cruisemonkey.controllers.DeckList","cruisemonkey.controllers.Events","cruisemonkey.controllers.Header","cruisemonkey.controllers.Login","cruisemonkey.controllers.Logout","cruisemonkey.Database","cruisemonkey.Navigation","cruisemonkey.Events","cruisemonkey.User","ek.mobileFrame","btford.phonegap.ready"]).config(["$routeProvider","$mobileFrameProvider",function(a,b){a.when("/login",{templateUrl:"template/login.html",controller:"CMLoginCtrl"}).when("/logout",{templateUrl:"template/logout.html",controller:"CMLogoutCtrl"}).when("/events",{redirectTo:"/events/official/"}).when("/events/:eventType",{templateUrl:"template/event-list.html",controller:"CMEventCtrl",resolve:{events:["$q","$route","$timeout","EventService","LoggingService",function(a,b,c,d,e){var f,g=b.current.params.eventType;"official"===g?f=d.getOfficialEvents:"unofficial"===g?f=d.getPublicEvents:"my"===g?f=d.getMyEvents:e.warn("unknown event type: "+g);var h=a.defer();return f?a.when(f()).then(function(a){var b,c={};for(b=0;b<a.length;b++){var d=a[b];d.hasOwnProperty("isFavorite")||(d.isFavorite=!1),c[d._id]=d}h.resolve(c)}):c(function(){h.reject("unknown event type")},0),h.promise}]}}).when("/deck-plans",{redirectTo:"/deck-plans/2/"}).when("/deck-plans/:deck",{templateUrl:"template/deck-plans.html",controller:"CMDeckListCtrl"}).when("/about",{templateUrl:"template/about.html",controller:"CMAboutCtrl"}).otherwise({redirectTo:"/events/official/"}),b.setHeaderHeight(40).setFooterHeight(0).setNavWidth(250)}]).run(["$rootScope","$location","UserService","phonegapReady",function(a,b,c,d){d(function(){StatusBar&&(console.log("StatusBar exists, isVisible = "+StatusBar.isVisible),StatusBar.overlaysWebView(!1),StatusBar.backgroundColorByName("black"))}),a.$on("$routeChangeStart",function(d,e,f){return a.actions=[],a.user=c.get(),c.loggedIn()?(angular.noop(),void 0):"template/event-list.html"===e.templateUrl&&"my"===e.params.eventType?(d.preventDefault(),b.path("/login/"),angular.noop(),void 0):(f&&f.access&&f.access.requiresLogin&&(d.preventDefault(),b.path("/login/"),angular.noop()),angular.noop(),void 0)});var e=function(){var a=b.path();angular.forEach(document.getElementById("nav").children,function(b){if(b.children[0]){var c=b.children[0].href;if(c){"/"===c.charAt(c.length-1)&&(c=c.substr(0,c.length-1));var d=c.indexOf("#");-1!==d&&(c=c.substring(c.indexOf("#")+1)),""===c?angular.element(b).removeClass("selected"):a.startsWith(c)?angular.element(b).addClass("selected"):angular.element(b).removeClass("selected")}}})};a.$on("$routeChangeSuccess",function(){e()}),a.$on("cm.loggedIn",function(){console.log("User logged in, refreshing menu."),e()}),a.$on("cm.loggedOut",function(){console.log("User logged out, refreshing menu."),e()}),a.hideSpinner=!0}])}();