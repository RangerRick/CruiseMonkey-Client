<!DOCTYPE html>
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en" manifest="cruisemonkey.manifest"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en" manifest="cruisemonkey.manifest"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en" manifest="cruisemonkey.manifest"> <![endif]-->
<!--[if gt IE 8]><!-->
<!-- manifest="cruisemonkey.manifest" -->
<html xmlns:ng="http://angularjs.org" lang="en" manifest="cruisemonkey.manifest">
<!--<![endif]-->
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, height=device-height, user-scalable=0, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" />
<style>
	[ng-cloak] {
		display: none;
	}
</style>
<link rel="stylesheet" href="css/3rdparty/normalize.css" />
<link rel="stylesheet" href="css/angular-mobile-frame.min.css" />
<link rel="stylesheet" href="bower_components/angular-datepicker/dist/index.min.css" />
<link rel="stylesheet" href="css/cruisemonkey/cruisemonkey.css" />

<!-- <script src="http://debug.phonegap.com/target/target-script-min.js#RangerRick182347"></script> -->
<script src="js/3rdparty/modernizr-latest.js"></script>
<!-- IE Fix for HTML5 Tags -->
<!--[if lt IE 9]>
		<script src="bower_components/html5shiv/dist/html5shiv.js"></script>
	<![endif]-->

<script>
if (window.applicationCache && window.applicationCache.addEventListener) {
	window.addEventListener('load', function(e) {
		window.applicationCache.addEventListener('updateready', function(e) {
			if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
				// Browser downloaded a new app cache.
				// Swap it in and reload the page to get the new hotness.
				console.log('a new version is available; reloading');
				window.applicationCache.swapCache();
				window.location.reload();
			}
		}, false);
	}, false);
}

var timeoutID;

document.addEventListener("deviceready", function() {
	if (timeoutID) {
		window.clearTimeout(timeoutID);
	}

	console.log('CruiseMonkey loaded.');
	angular.bootstrap(document, ['cruisemonkey']);
	FastClick.attach(document.body);
}, false);

timeoutID = window.setTimeout(function() {
	console.log('Firing deviceready manually.');
	window.clearTimeout(timeoutID);
	var e = document.createEvent('Events');
	e.initEvent('deviceready', true, true);
	document.dispatchEvent(e);
}, 500);

/*
window.setTimeout(function() {
	if (window.device) {
		console.log('This is a phonegap device, not bothering to update the application cache.');
	} else {
		window.setInterval(function() {
			window.applicationCache.update();
		}, 5000);
	}
}, 30000);
*/
  </script>
  <title ng-bind="'CruiseMonkey - ' + $root.title">CruiseMonkey</title>
</head>
<body class="antialiased off-canvas hide-extras" ng-cloak>
	<mobile-frame>
		<mobile-header ng-controller="CMHeaderCtrl">
			<span class="title"><strong>{{title}}</strong></span>
			<span class="actions" ng-repeat="action in actions">
				<div class="action icon icon-{{action.iconClass}}" ng-click="action.launch()"></div>
			</span>
		</mobile-header>
		<mobile-nav ng-controller="CMNavigationCtrl" ng-click="toggleDrawer()">
			<ul class="nav" id="nav">
				<li class="sidebar-header">CruiseMonkey</li>
				<li><a href="#/events/official/"  >Official Events</a></li>
				<li><a href="#/events/unofficial/">Unofficial Events</a></li>
				<li><a href="#/events/my/"        >My Events</a></li>
				<li><a href="#/deck-plans/"       >Deck Plans</a></li>
				<li><a href="#/about/"            >About</a></li>

				<li ng-show="!user.loggedIn"><a href="#/login/">Log In</a></li>
				<li ng-show="user.loggedIn" ><a href="#/logout/">Log Out</a></li>
			</ul>
		</mobile-nav>
		<mobile-content ng-view>
		</mobile-content>
	</mobile-frame>

	<!--
	!!!! <script src="bower_components/jquery/jquery.min.js"></script>
	<script src="js/3rdparty/pouchdb-nightly.min.js"></script>
	<script src="bower_components/hammerjs/dist/hammer.min.js"></script>
	<script src="bower_components/momentjs/min/moment.min.js"></script>
	<script src="bower_components/log4javascript/log4javascript.js"></script>
	<script src="bower_components/angular/angular.min.js"></script>
	<script src="bower_components/angular-loader/angular-loader.min.js"></script>
	<script src="bower_components/angular-route/angular-route.min.js"></script>
	<script src="bower_components/angular-resource/angular-resource.min.js"></script>
	!!!! <script src="bower_components/angular-datepicker/dist/index.min.js"></script>
	<script src="js/angular-3rdparty/angular-hammer.min.js"></script>
	-->

	<script src="bower_components/jquery/jquery.js"></script>
	<script src="js/3rdparty/pouchdb-nightly.js"></script>
	<script src="bower_components/hammerjs/dist/hammer.js"></script>
	<script src="bower_components/momentjs/moment.js"></script>
	<script src="bower_components/log4javascript/log4javascript_uncompressed.js"></script>
	<script src="bower_components/angular/angular.js"></script>
	<script src="bower_components/angular-loader/angular-loader.js"></script>
	<script src="bower_components/angular-route/angular-route.js"></script>
	<script src="bower_components/angular-resource/angular-resource.js"></script>
	<!-- <script src="bower_components/angular-datepicker/dist/index.js"></script> -->
	<script src="js/angular-3rdparty/angular-hammer.js"></script>

	<script src="bower_components/fastclick/lib/fastclick.js"></script>
	<script src="bower_components/angular-phonegap-ready/ready.js"></script>
	<script src="bower_components/angular-localstorage/angular-local-storage.js"></script>
	<script src="js/angular-3rdparty/angular-mobile-frame.js"></script>
	<script src="js/angular-3rdparty/angular-interval.js"></script>
	<script src="js/angular-3rdparty/ui-bootstrap-0.6.0.js"></script>

	<script src="js/cruisemonkey.min.js"></script>
	<script src="phonegap.js"></script>
</body>
</html>
